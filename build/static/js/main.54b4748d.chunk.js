(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{116:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},127:function(e,t,n){},133:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(9),o=n.n(s),i=n(10),c=n(20),l=n(17),u=n(18),p=n(80),h=n(14),d=n(12),j=n.n(d),b=n(21),x=n(19),g=n.n(x),v=(n(116),n(2)),O=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={username:"",email:"",password:"",github:""},e.componentDidMount=function(){console.log()},e.handleRegister=Object(b.a)(j.a.mark((function t(){var n,a,r,s,o,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.email,r=n.username,s=n.github,o=n.password,t.prev=1,t.next=4,g.a.post("/api/register/",{email:a,username:r,github:s,password:o});case 4:i=t.sent,console.log(i),201===i.status&&(window.location="/login"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("error",t.t0),alert("Invalid Inputs!");case 13:case"end":return t.stop()}}),t,null,[[1,9]])}))),e}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{id:"register-page",children:[Object(v.jsx)("h1",{children:"CMPUT404 Social Distribution"}),Object(v.jsx)("i",{className:"fas fa-id-card fa-1x"}),Object(v.jsx)("input",{type:"text",id:"username",placeholder:"your username",value:this.state.username,onChange:function(t){return e.setState({username:t.target.value})}}),Object(v.jsx)("i",{className:"fas fa-envelope-open-text"}),Object(v.jsx)("input",{type:"email",id:"email",placeholder:"your email",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}}),Object(v.jsx)("i",{className:"fas fa-key"}),Object(v.jsx)("input",{type:"password",id:"pwd",placeholder:"your passowrd",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}}),Object(v.jsx)("i",{className:"fab fa-github"}),Object(v.jsx)("input",{type:"text",id:"github",placeholder:"your github",value:this.state.github,onChange:function(t){return e.setState({github:t.target.value})}}),Object(v.jsx)("button",{id:"register-btn",onClick:this.handleRegister,children:"submit"})]})}}]),n}(a.Component),f=O,m=n(25),y="SET_CURRENT_USER",w=function(e){return{type:y,payload:e}},k=(n(123),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:""},e.handelLogin=Object(b.a)(j.a.mark((function t(){var n,a,r,s;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.email,r=n.password,t.prev=1,t.next=4,g.a.post("/api/login/",{email:a,password:r});case 4:s=t.sent,console.log(s),e.props.setCurrentUser(s.data.authorID),console.log("redux store:",e.props.authorID),window.location="/home",t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0),alert("invalid data!");case 15:case"end":return t.stop()}}),t,null,[[1,11]])}))),e.componentDidMount=function(){console.log("props in Login:",e.props)},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{id:"login-page",children:[Object(v.jsx)("h1",{children:"CMPUT404 Social Distribution"}),Object(v.jsx)("i",{className:"fas fa-envelope-open-text"}),Object(v.jsx)("input",{type:"email",id:"login-email",placeholder:"your email",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}}),Object(v.jsx)("i",{className:"fas fa-key"}),Object(v.jsx)("input",{type:"password",id:"login-pwd",placeholder:"your passowrd",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}}),Object(v.jsx)("button",{id:"login-btn",onClick:this.handelLogin,children:"Login"})]})}}]),n}(a.Component)),C=Object(m.b)((function(e){return{authorID:e.user.authorID}}),(function(e){return{setCurrentUser:function(t){e(w(t))}}}))(k),I=(n(124),n(169)),P=function(e){return Object(v.jsxs)("div",{id:"user-header",children:[Object(v.jsxs)("h1",{children:["Welcome To Social Distribution,  ",e.currentUser.displayName," "]}),Object(v.jsx)("hr",{}),Object(v.jsx)("hr",{}),Object(v.jsx)("hr",{}),Object(v.jsxs)("div",{children:[Object(v.jsx)(I.a,{id:"user-avatar",children:e.currentUser.displayName.slice(0,1)}),Object(v.jsxs)("div",{id:"user-info",children:[Object(v.jsxs)("h2",{children:["Email: ",e.currentUser.email]}),Object(v.jsxs)("h2",{children:["Github: ",e.currentUser.github]})]})]})]})},D=n(168),U=n(85),T=(n(125),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).renderPostContent=function(){var t=e.props.post.contentType;switch(console.log(t),t){default:return Object(v.jsx)("p",{children:e.props.post.content});case"text/markdown":return Object(v.jsx)(U.a,{children:e.props.post.content});case"image/png;base64":case"image/jpeg;base64":return Object(v.jsx)("div",{children:Object(v.jsx)("img",{className:"imagePreview",src:e.props.post.content,alt:"Unavailable"})})}},e.deletepostClick=Object(b.a)(j.a.mark((function t(){var n,a,r,s,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props.authorID,a=e.props.post.author_id,r=e.props.post.id,s=r.split("/"),o=s[s.length-1],n===a){t.next=9;break}window.alert("you cannot delete this post"),t.next=18;break;case 9:return t.prev=9,t.next=12,g.a.delete("api/author/".concat(a,"/posts/").concat(o,"/"));case 12:200===t.sent.status&&e.props.handlePostView(),t.next=18;break;case 16:t.prev=16,t.t0=t.catch(9);case 18:case"end":return t.stop()}}),t,null,[[9,16]])}))),e}return Object(c.a)(n,[{key:"render",value:function(){return Object(v.jsxs)("div",{style:{border:"solid 1px grey"},children:[Object(v.jsx)("h1",{children:this.props.post.title}),Object(v.jsx)("h4",{children:this.props.post.author.displayName}),Object(v.jsxs)("h4",{children:["description: ",this.props.post.description]}),Object(v.jsx)("p",{id:"post-text",children:this.renderPostContent()}),Object(v.jsxs)("h4",{children:["published at ",Date(this.props.post.published)]}),Object(v.jsx)(D.a,{style:{color:"black",backgroundColor:"grey"},onClick:this.deletepostClick,children:"Delete"}),Object(v.jsx)("br",{})]})}}]),n}(a.Component)),S=Object(m.b)((function(e){return{authorID:e.user.authorID}}))(T),L=n(79),N=n(37),R=n(167),A=(n(127),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).componentDidMount=function(){},a.onImageChange=function(e){e.target.files&&e.target.files[0]&&a.setState({img:e.target.files[0]},(function(){a.setState({imagePreview:URL.createObjectURL(a.state.img)})}))},a.getBase64=function(e){var t=new FileReader;return t.readAsDataURL(e),new Promise((function(e){t.onload=function(t){e(t.target.result)}}))},a.showOpenFileDlg=function(){a.chooseFile.current.click()},a.handleShow=function(){var e=a.state.show;a.setState({show:!e,visibility:"PUBLIC",description:"",title:"",content:"",unlisted:!1,imagePreview:null,img:null})},a.sendPost=function(){var e=Object(b.a)(j.a.mark((function e(t,n,r){var s,o,i,c,l,u,p,h,d,b,x,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("PRIVATE"!==r){e.next=10;break}return e.next=3,g.a.get("api/author/".concat(a.state.privateToAuthor,"/"));case 3:s=e.sent,o={type:"post",post_id:n},i=s.data.id.split("/"),c=i[i.length-1],g.a.post("api/author/".concat(c,"/inbox/"),o),e.next=23;break;case 10:if("PUBLIC"!==r){e.next=16;break}return e.next=13,g.a.get("api/author/");case 13:e.sent,e.next=23;break;case 16:if("FRIEND"!==r){e.next=23;break}return e.next=19,g.a.get("api/author/".concat(t,"/friends/"));case 19:l=e.sent,u=l.data.items,p=Object(L.a)(u);try{for(p.s();!(h=p.n()).done;)d=h.value,console.log(d),b={type:"post",post_id:n},console.log(b),x=d.id.split("/"),v=x[x.length-1],console.log(v),v!==a.props.authorID&&g.a.post("api/author/".concat(v,"/inbox/"),b)}catch(j){p.e(j)}finally{p.f()}case 23:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),a.handlePost=Object(b.a)(j.a.mark((function e(){var t,n,r,s,o,i,c,l,u,p,h,d,b;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.state,n=t.title,r=t.description,s=t.category,o=t.visibility,i=t.unlisted,c=a.props.authorID,"image"!==a.state.contentType){e.next=10;break}return e.next=5,a.getBase64(a.state.img);case 5:l=e.sent,u=l.slice(5).split(",")[0],p=l,e.next=11;break;case 10:"text/plain"!==a.state.contentType&&"text/markdown"!==a.state.contentType||(u=a.state.contentType,console.log(u),p=a.state.content);case 11:if(!(n&&r&&p)){e.next=28;break}return e.prev=12,e.next=15,g.a.post("api/author/".concat(c,"/posts/"),{title:n,description:r,content:p,category:s,visibility:o,unlisted:i,contentType:u});case 15:h=e.sent,a.props.handlePostView(),a.setState({show:!1,visibility:"PUBLIC",description:"",title:"",content:"",unlisted:!1,contentType:"text/plain"}),d=h.data.id.split("/"),b=d[d.length-1],i?alert("this is the unlisted POST ID: "+b):a.sendPost(c,b,o),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),console.log(e.t0.message);case 26:e.next=29;break;case 28:alert("Invalid Post Form !!!");case 29:case"end":return e.stop()}}),e,null,[[12,23]])}))),a.state={show:!1,title:"",description:"",contentType:"text/plain",category:"WEB TUTORIAL",content:"",visibility:"PUBLIC",unlisted:!1,imagePreview:null,img:null,privateToAuthor:""},a.onImageChange=a.onImageChange.bind(Object(N.a)(a)),a.chooseFile=r.a.createRef(),a}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.show,a=t.title,r=t.description,s=t.content,o=t.contentType,i=t.unlisted,c=t.privateToAuthor;return Object(v.jsx)("div",{children:null!==this.props.authorID?Object(v.jsxs)("div",{id:"form-control",children:[Object(v.jsxs)(D.a,{variant:"outlined",color:"primary",onClick:this.handleShow,children:[" ",n?"Cancel":"Create Post"]}),n?Object(v.jsxs)("div",{id:"post-form",children:[Object(v.jsx)(R.a,{style:{width:300},label:"Title",value:a,onChange:function(t){return e.setState({title:t.target.value})}}),Object(v.jsx)("br",{}),Object(v.jsx)(R.a,{style:{width:300},label:"Description",value:r,onChange:function(t){return e.setState({description:t.target.value})}}),Object(v.jsx)("br",{}),"text/plain"===o||"text/markdown"===o?Object(v.jsxs)("div",{children:[Object(v.jsx)(R.a,{style:{width:350},label:"Content",multiline:!0,rows:10,value:s,onChange:function(t){return e.setState({content:t.target.value})}}),Object(v.jsx)("br",{})]}):Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{variant:"outlined",color:"primary",onClick:this.showOpenFileDlg,children:"Choose Image"}),Object(v.jsx)("br",{}),Object(v.jsx)("input",{type:"file",ref:this.chooseFile,onChange:this.onImageChange,style:{display:"none"},accept:"image/png, image/jpeg"}),Object(v.jsx)("div",{children:Object(v.jsx)("img",{className:"imagePreview",src:this.state.imagePreview,alt:"Unavailable"})})]}),Object(v.jsx)("label",{children:"Content Type:"}),Object(v.jsxs)("select",{onChange:function(t){e.setState({contentType:t.target.value})},children:[Object(v.jsx)("option",{value:"text/plain",children:"plaintext"}),Object(v.jsx)("option",{value:"text/markdown",children:"markdown"}),Object(v.jsx)("option",{value:"image",children:"image"})]}),Object(v.jsx)("label",{children:"Visibility:"}),Object(v.jsxs)("select",{onChange:function(t){e.setState({visibility:t.target.value})},children:[Object(v.jsx)("option",{value:"PUBLIC",children:"PUBLIC"}),Object(v.jsx)("option",{value:"FRIEND",children:"FRIEND"}),Object(v.jsx)("option",{value:"PRIVATE",children:"PRIVATE"})]}),Object(v.jsx)("p",{children:this.state.visibility}),Object(v.jsx)("label",{children:"Unlisted:"}),Object(v.jsx)("input",{type:"checkbox",checked:i,onChange:function(t){return e.setState({unlisted:t.target.checked})}}),"PRIVATE"===this.state.visibility?Object(v.jsx)(R.a,{style:{margin:10},value:c,onChange:function(t){return e.setState({privateToAuthor:t.target.value})},placeholder:"private to",variant:"filled"}):null,Object(v.jsx)(D.a,{style:{marginTop:15},variant:"outlined",color:"primary",onClick:this.handlePost,children:"Post"})]}):null]}):Object(v.jsx)("p",{children:"You are not logged in"})})}}]),n}(a.Component)),E=Object(m.b)((function(e){return{authorID:e.user.authorID}}))(A),V=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleLogout=function(){e.props.setCurrentUser(null),window.location="/login"},e}return Object(c.a)(n,[{key:"render",value:function(){return Object(v.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",height:20},children:Object(v.jsx)(D.a,{onClick:this.handleLogout,children:"Log out"})})}}]),n}(a.Component),B=Object(m.b)(null,(function(e){return{setCurrentUser:function(t){e(w(t))}}}))(V),F=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentUser:null,publicPosts:[]},e.componentDidMount=Object(b.a)(j.a.mark((function t(){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.props.authorID),t.next=3,g.a.get("/api/author/".concat(e.props.authorID,"/"));case 3:return n=t.sent,t.next=6,e.handlePostView();case 6:e.setState({currentUser:n.data});case 7:case"end":return t.stop()}}),t)}))),e.handlePostView=Object(b.a)(j.a.mark((function t(){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.props.authorID){t.next=14;break}return t.prev=1,t.next=4,g.a.get("/api/posts/");case 4:n=t.sent,console.log(n.data.posts),e.setState({publicPosts:n.data.posts.filter((function(e){return"PUBLIC"===e.visibility&&!1===e.unlisted}))}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:t.next=15;break;case 14:alert("Not Logged In!");case 15:case"end":return t.stop()}}),t,null,[[1,9]])}))),e.showInbox=Object(b.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.props.authorID){t.next=12;break}return t.prev=1,t.next=4,g.a.get("/api/author/".concat(e.props.authorID,"/inbox/"));case 4:t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0);case 10:t.next=13;break;case 12:alert("Not Logged In!");case 13:case"end":return t.stop()}}),t,null,[[1,7]])}))),e.clearInbox=Object(b.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===e.props.authorID){t.next=12;break}return t.prev=1,t.next=4,g.a.delete("/api/author/".concat(e.props.authorID,"/inbox/"));case 4:t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0);case 10:t.next=13;break;case 12:alert("Not Logged In!");case 13:case"end":return t.stop()}}),t,null,[[1,7]])}))),e.renderHeader=function(){var t=e.state.currentUser;return null===t?"":Object(v.jsx)(P,{currentUser:t})},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(B,{}),Object(v.jsx)("div",{children:this.renderHeader()}),Object(v.jsx)("div",{children:0!==this.state.publicPosts.length?this.state.publicPosts.map((function(t,n){return Object(v.jsx)(S,{post:t,handlePostView:e.handlePostView},n)})):Object(v.jsx)("h1",{style:{display:"flex",justifyContent:"center"},children:"No Posts"})}),Object(v.jsx)("div",{children:Object(v.jsx)(E,{handlePostView:this.handlePostView})})]})}}]),n}(a.Component),M=Object(m.b)((function(e){return{authorID:e.user.authorID}}))(F),_=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(v.jsx)(p.a,{children:Object(v.jsxs)(h.c,{children:[Object(v.jsx)(h.a,{exact:!0,path:"/",component:f}),Object(v.jsx)(h.a,{exact:!0,path:"/login",component:C}),Object(v.jsx)(h.a,{exact:!0,path:"/home",component:M})]})})}}]),n}(a.Component),H=_,J=n(31),W=n(27),G=n(56),Y=n(82),q={authorID:null},z={key:"root",storage:n.n(Y).a,whitelist:["authorID"]},K=Object(G.a)(z,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;return t.type===y?Object(W.a)(Object(W.a)({},e),{},{authorID:t.payload}):e})),Q=Object(J.b)({user:K}),X=n(83),Z=[n.n(X).a],$=Object(J.c)(Q,J.a.apply(void 0,Z)),ee=n(84),te=Object(G.b)($);o.a.render(Object(v.jsx)(m.a,{store:$,children:Object(v.jsx)(ee.a,{persistor:te,children:Object(v.jsx)(H,{})})}),document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.54b4748d.chunk.js.map